
function exportPdf(){var a=new jsPDF("l","pt","letter");source=$("#data").get(0);specialElementHandlers={"#bypassme":function(b,c){return true}};margins={top:40,bottom:20,left:10,width:"100%"};a.fromHTML(source,margins.left,margins.top,{width:margins.width,elementHandlers:specialElementHandlers},function(b){a.save("Test.pdf")},margins)}function exportExcel(){if($("#form-semester").val()!=="-1"){$("#datatable").table2excel({exclude:".noExl",filename:$("#form-semester option:selected").text().trim(),fileext:".xls",name:"Horario",exclude_img:true,exclude_links:true,exclude_inputs:true})}}var days={1:"Lunes",2:"Martes",3:"Miercoles",4:"Jueves",5:"Viernes",6:"Sabado",7:"Domingo"};var colorClass={0:"info",1:"success",2:"danger",3:"warning"};function getRandomArbitrary(b,a){return Math.floor(Math.random()*(a-b))+b}$("#form-semester").change(function(){if($("#form-semester").val()!==""){var c={ID_Semester:$("#form-semester").val()};SEMICOLON.widget.notifications($("#wait"));$.post("?controller=Schedule&action=select",c,function(l){for(var f=1;f<=7;f++){for(var d=7;d<=19;d++){$("#"+days[f]+""+d).removeClass();$("#"+days[f]+""+d).text("")}}for(var h=0;h<l.length;h++){var e=getRandomArbitrary(0,4);for(var g=parseInt(l[h].start);g<=parseInt(l[h].end);g++){$("#"+l[h].day+""+g).addClass(colorClass[e]);$("#"+l[h].day+""+g).text(l[h].initials+" | "+l[h].name)}}},"json")}else{for(var b=1;b<=7;b++){for(var a=7;a<=19;a++){$("#"+days[b]+""+a).removeClass();$("#"+days[b]+""+a).text("")}}}});